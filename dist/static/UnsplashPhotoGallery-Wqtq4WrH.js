import{r as p,j as m,c as Y,E as K,K as B,T as S,al as re,C as oe}from"./sanity-DIL4OtZx.js";function ie(t){const[e,s]=p.useState(t);return t!==e&&(!t||!e||t.length!==e.length||t.some((n,r)=>n!==e[r]))?(s(t),t):e}function ce(t,[e,s]){const[n,r]=t;return n!==void 0&&r!==void 0&&e!==void 0&&s!==void 0&&e>n&&e-n<=20&&s<r?[n,s]:n!==e||r!==s?[e,s]:t}function ae(t,e){let s=t?.clientWidth;if(s!==void 0&&e&&e.length>0){const n=[...e.filter(r=>r>0)].sort((r,u)=>u-r);n.push(Math.floor(n[n.length-1]/2)),s=n.find((r,u)=>r<=s||u===n.length-1)}return s}function le(t,e,s){const[[n],r]=p.useReducer(ce,[s]),u=ie(e),c=p.useRef(void 0);return{containerRef:p.useCallback(a=>{c.current?.disconnect(),c.current=void 0;const f=()=>r([ae(a,u),window.innerWidth-document.documentElement.clientWidth]);f(),a&&typeof ResizeObserver<"u"&&(c.current=new ResizeObserver(f),c.current.observe(a)),typeof t=="function"?t(a):t&&(t.current=a)},[t,u]),containerWidth:n}}function ue(...t){return[...t].filter(Boolean).join(" ")}function Z(t){return["react-photo-album",t].filter(Boolean).join("--")}function de(t){return`--${Z(t)}`}function H({width:t,height:e}){return t/e}const fe=Object.freeze([1200,600,300,0]);function I(t,e){return typeof t=="function"?t(e):t}function J(t,e){return e!==void 0?I(t,e):void 0}function he(t,e){const s=fe.findIndex(n=>n<=e);return I(t[Math.max(s,0)],e)}function _(t,e,s,n=0){if(e===void 0)return;const r=J(t,e);return Math.round(Math.max(r===void 0?he(s,e):r,n))}function pe(t,{spacing:e,padding:s,componentsProps:n,render:r}){return{spacing:_(e,t,[20,15,10,5]),padding:_(s,t,[0,0,0,0]),componentsProps:I(n,t)||{},render:I(r,t)}}function z(t,e=0){const s=10**e;return Math.round((t+Number.EPSILON)*s)/s}function me(t,e,s,n,r,u,c){let d,a;const f=i=>{const o=u*(r-1)+2*c*r;return`calc((${i.match(/^\s*calc\((.*)\)\s*$/)?.[1]??i} - ${o}px) / ${z((n-o)/s,5)})`},l=t.srcSet;return l&&l.length>0&&(d=l.concat(l.some(({width:i})=>i===t.width)?[]:[{src:t.src,width:t.width,height:t.height}]).sort((i,o)=>i.width-o.width).map(i=>`${i.src} ${i.width}w`).join(", ")),e?.size?a=(e.sizes||[]).map(({viewport:i,size:o})=>`${i} ${f(o)}`).concat(f(e.size)).join(", "):a=`${Math.ceil(s/n*100)}vw`,{srcSet:d,sizes:a}}function ge({as:t,render:e,context:s,classes:n=[],variables:r={},style:u,className:c,children:d,...a},f){const l=ue(...(Array.isArray(n)?n:[n]).filter(h=>typeof h=="string").map(Z),c),o={style:{...Object.fromEntries(Object.entries(r).map(([h,w])=>[de(h.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),typeof w=="number"?z(w,5):w])),...u},className:l,children:d,...a};if(e){const h=e({ref:f,...o},s);if(h)return h}const g=t||"div";return m.jsx(g,{ref:f,...o})}const A=p.forwardRef(ge);function ve({photo:t,index:e,width:s,height:n,onClick:r,render:{wrapper:u,link:c,button:d,image:a,extras:f}={},componentsProps:{link:l,button:i,wrapper:o,image:g}={}},h){const{href:w}=t,k={photo:t,index:e,width:z(s,3),height:z(n,3)};let y;return w?y={...l,as:"a",render:c,classes:["photo","link"],href:w,onClick:r}:r?y={...i,as:"button",type:"button",render:d,classes:["photo","button"],onClick:r}:y={...o,render:u,classes:"photo"},m.jsxs(A,{ref:h,variables:{photoWidth:k.width,photoHeight:k.height},context:k,...y,children:[m.jsx(A,{as:"img",classes:"image",render:a,context:k,...g}),f?.({},k)]})}const be=p.forwardRef(ve);function we({layout:t,sizes:e,model:s,skeleton:n,onClick:r,render:{container:u,track:c,photo:d,...a}={},componentsProps:{container:f,track:l,link:i,button:o,wrapper:g,image:h}={}},w){const{spacing:k,padding:y,containerWidth:P,tracks:C,variables:$,horizontal:E}=s||{};return m.jsxs(A,{role:"group","aria-label":"Photo album",...f,variables:{spacing:k,padding:y,containerWidth:P,...$},classes:["",t],render:u,ref:w,children:[k!==void 0&&y!==void 0&&P!==void 0&&C?.map(({photos:R,variables:O},v)=>{const b=R.length,x=E?b:C.length;return p.createElement(A,{...l,key:v,render:c,classes:"track",variables:{trackSize:b,...O}},R.map(j=>{const{photo:M,index:N,width:ee}=j,{key:te,src:T,alt:ne,title:se,label:U}=M,F=r?L=>{r({event:L,photo:M,index:N})}:void 0;if(d){const L=d({onClick:F},j);if(L)return L}const G=L=>U?{"aria-label":U,...L}:L;return m.jsx(be,{onClick:F,render:a,componentsProps:{image:{loading:"lazy",decoding:"async",src:T,alt:ne,title:se,...me(M,e,ee,P,x,k,y),...I(h,j)},link:G(I(i,j)),button:G(I(o,j)),wrapper:I(g,j)},...j},te??T)}))}),P===void 0&&n]})}const xe=p.forwardRef(we);function ye(t,{photos:e,targetRowHeight:s,rowConstraints:n,...r}){const{spacing:u,padding:c,componentsProps:d,render:a}=pe(t,r),{singleRowMaxHeight:f,minPhotos:l,maxPhotos:i}=J(n,t)||{};if(f!==void 0&&u!==void 0&&c!==void 0){const o=Math.floor(e.reduce((g,{width:h,height:w})=>g+h/w*f-2*c,c*e.length*2+u*(e.length-1)));o>0&&(d.container={...d.container},d.container.style={maxWidth:o,...d.container.style})}return{...r,targetRowHeight:_(s,t,[o=>o/5,o=>o/4,o=>o/3,o=>o/2]),render:a,spacing:u,padding:c,minPhotos:l,maxPhotos:i,componentsProps:d}}function ke(t){return(e,s)=>t(s)-t(e)}function Pe(t){let e=0;const s=[],n=(l,i)=>t(s[l],s[i])<0,r=(l,i)=>{const o=s[l];s[l]=s[i],s[i]=o},u=l=>{let i=l,o=Math.floor(i/2);for(;i>1&&n(o,i);)r(o,i),i=o,o=Math.floor(i/2)},c=l=>{let i=l,o=i*2;for(;o<=e&&(o<e&&n(o,o+1)&&(o+=1),!!n(i,o));)r(i,o),i=o,o=i*2};return{push:l=>{e+=1,s[e]=l,u(e)},pop:()=>{if(e===0)return;r(1,e),e-=1;const l=s.pop();return c(1),l},size:()=>e}}function Re(t,e,s){const n=new Map,r=new Set,u=new Map;u.set(e,0);const c=Pe(ke(d=>d[1]));for(c.push([e,0]);c.size()>0;){const[d,a]=c.pop();if(!r.has(d)){const f=t(d);r.add(d),f.forEach((l,i)=>{const o=a+l,g=n.get(i),h=u.get(i);(h===void 0||h>o&&(h/o>1.005||g!==void 0&&g<d))&&(u.set(i,o),c.push([i,o]),n.set(i,d))})}}return u.has(s)?n:void 0}function je(t,e){if(!t)return;const s=[];for(let n=e;n!==void 0;n=t.get(n))s.push(n);return s.reverse()}function Ce(t,e,s){return je(Re(t,e,s),s)}function Ee(t,e,s,n){return z(e/s/Math.min(...t.map(r=>H(r))))+(n||0)+2}function Q(t,e,s,n){return(e-(t.length-1)*s-2*n*t.length)/t.reduce((r,u)=>r+H(u),0)}function $e(t,e,s,n,r,u,c){const d=t.slice(e,s),a=Q(d,n,r,u);return a>0?(a-c)**2*d.length:void 0}function Oe(t,e,s,n,r,u,c,d){return a=>{const f=new Map;f.set(a,0);const l=c||1,i=Math.min(u,d||1/0);for(let o=a+l;o<t.length+1&&!(o-a>i);o+=1){const g=$e(t,a,o,n,e,s,r);if(g===void 0)break;f.set(o,g)}return f}}function Ie(t,e,s,n,r,u,c){const d=Ee(t,n,r,u),a=Oe(t,e,s,n,r,d,u,c),f=Ce(a,0,t.length);if(!f)return;const l=[];for(let i=1;i<f.length;i+=1){const o=t.map((h,w)=>({photo:h,index:w})).slice(f[i-1],f[i]),g=Q(o.map(({photo:h})=>h),n,e,s);l.push({photos:o.map(({photo:h,index:w})=>({photo:h,index:w,width:g*H(h),height:g}))})}return{spacing:e,padding:s,containerWidth:n,tracks:l,horizontal:!0}}function Me({photos:t,breakpoints:e,defaultContainerWidth:s,...n},r){const{containerRef:u,containerWidth:c}=le(r,e,s),{spacing:d,padding:a,targetRowHeight:f,minPhotos:l,maxPhotos:i,...o}=ye(c,{photos:t,...n}),g=p.useMemo(()=>c!==void 0&&d!==void 0&&a!==void 0&&f!==void 0?Ie(t,d,a,c,f,l,i):void 0,[t,d,a,c,f,l,i]);return m.jsx(xe,{layout:"rows",ref:u,model:g,...o})}const Le=p.forwardRef(Me),D=new Map;function ze(t,e){let s=D.get(e);if(!s){const n=new Map;s={observer:new IntersectionObserver(u=>{u.forEach(c=>{n.get(c.target)?.forEach(d=>{d(c)})})},{root:t,rootMargin:e}),listeners:n},D.set(e,s)}return s}function W(t,e){const s=e?.()??null;return p.useMemo(()=>{const n=[];return{observe:(c,d)=>{const{observer:a,listeners:f}=ze(s,t),l=f.get(c)||[];l.push(d),f.set(c,l),a.observe(c),n.push(()=>{l.splice(l.indexOf(d),1),l.length===0&&(f.delete(c),a.unobserve(c)),f.size===0&&(a.disconnect(),D.delete(t))})},unobserve:()=>{n.forEach(c=>c()),n.splice(0,n.length)}}},[s,t])}function q({rootMargin:t,scrollContainer:e,children:s}){const[n,r]=p.useState(),{observe:u,unobserve:c}=W(t,e),d=p.useCallback(a=>{c(),a&&u(a,({isIntersecting:f})=>{if(f)r(void 0);else{const{width:l,height:i}=a.getBoundingClientRect(),{margin:o}=getComputedStyle(a);r({aspectRatio:`${l} / ${i}`,margin:o})}})},[u,c]);return n?m.jsx("div",{ref:d,style:n}):p.cloneElement(s,{ref:d})}const Ae=typeof window<"u"?p.useLayoutEffect:p.useEffect;function Ne(t){const e=p.useRef(t);return Ae(()=>{e.current=t}),p.useCallback((...s)=>e.current?.(...s),[])}var Se=(t=>(t[t.IDLE=0]="IDLE",t[t.LOADING=1]="LOADING",t[t.ERROR=2]="ERROR",t[t.FINISHED=3]="FINISHED",t))(Se||{});function _e({photos:t,onClick:e,fetch:s,retries:n=0,singleton:r,error:u,loading:c,finished:d,children:a,scrollContainer:f,fetchRootMargin:l="800px",offscreenRootMargin:i="2000px"}){const[o,g]=p.useState(0),[h,w]=p.useState(()=>t?[t]:[]),{observe:k,unobserve:y}=W(l,f),P=p.useRef(!1),C=Ne(v=>{let b=1;const x=async()=>{try{return await s(v)}catch(j){if(b>n)throw j;return await new Promise(M=>{setTimeout(M,1e3*2**(b-1))}),b+=1,x()}};return x()}),$=p.useCallback(async()=>{if(P.current)return;const v=b=>{P.current=b===1,g(b)};v(1);try{const b=await C(h.length);if(b===null){v(3);return}w(x=>[...x,b]),v(0)}catch{v(2)}},[h.length,C]),E=p.useCallback(v=>{y(),v&&k(v,({isIntersecting:b})=>{b&&$()})},[k,y,$]),R=h.flatMap(v=>v),O=e?({photo:v,event:b})=>{e({photos:R,index:R.findIndex(x=>x===v),photo:v,event:b})}:void 0;return m.jsxs(m.Fragment,{children:[r?p.cloneElement(a,{photos:R,onClick:O,render:{...a.props.render,track:({children:v,...b})=>m.jsx("div",{...b,children:p.Children.map(v,(x,j)=>p.isValidElement(x)&&m.jsx(q,{rootMargin:i,scrollContainer:f,children:x},j))})}}):h.map((v,b)=>m.jsx(q,{rootMargin:i,scrollContainer:f,children:p.cloneElement(a,{photos:v,onClick:O})},b)),o===2&&u,o===1&&c,o===3&&d,m.jsx("span",{ref:E})]})}async function De(t,e){const s=e.links.download_location.replace("https://api.unsplash.com","/addons/unsplash"),{url:n}=await t.request({url:s,withCredentials:!0,method:"GET"});return n}const He=K.a.withConfig({displayName:"CreditLineLink",componentId:"sc-s8c1fx-0"})`text-decoration:none;cursor:pointer;&:hover,&:focus{[data-ui='Text']{text-decoration:underline;}}`,Te=K(oe).withConfig({displayName:"CreditLine",componentId:"sc-s8c1fx-1"})`${({theme:t})=>`
     --creditline-fg: ${t.sanity.color.card.enabled.fg};
     --creditline-bg: ${t.sanity.color.card.enabled.bg};
   `};-webkit-user-drag:none;position:absolute;background-color:var(--creditline-bg);bottom:0;[data-ui='Text']{color:var(--creditline-fg);}`,Ue="sanity-plugin-asset-source-unsplash";function Fe(t){const e=Y.c(11),{link:s,id:n,userName:r}=t;let u,c;if(e[0]!==s){const l=new URL(s);l.searchParams.set("utm_source",Ue),l.searchParams.set("utm_medium","referral"),u=He,c=l.toString(),e[0]=s,e[1]=u,e[2]=c}else u=e[1],c=e[2];const d=`Open image by ${r} on Unsplash in new window`;let a;e[3]!==d||e[4]!==r?(a=m.jsx(Te,{padding:1,radius:1,margin:1,children:m.jsxs(S,{size:0,title:d,children:["By @",r]})}),e[3]=d,e[4]=r,e[5]=a):a=e[5];let f;return e[6]!==u||e[7]!==n||e[8]!==c||e[9]!==a?(f=m.jsx(u,{href:c,target:n,rel:"noreferrer noopener",onClick:Ge,children:a}),e[6]=u,e[7]=n,e[8]=c,e[9]=a,e[10]=f):f=e[10],f}function Ge(t){return t.stopPropagation()}const V=2,Be=1;function X(t){return{src:t.urls.small,width:t.width,height:t.height,key:t.id,data:t}}function Ye(t){const e=Y.c(33),{client:s,query:n,fetcher:r,scrollContainerRef:u,onSelect:c,initialDataPromise:d}=t,a=p.use(d),f=a.total===0?"visible":"hidden";let l;e[0]!==n?(l=m.jsx(B,{paddingX:2,paddingY:3,children:m.jsxs(S,{size:1,muted:!0,children:['No results found for "',n,'"']})}),e[0]=n,e[1]=l):l=e[1];let i;e[2]!==f||e[3]!==l?(i=m.jsx(p.Activity,{mode:f,children:l}),e[2]=f,e[3]=l,e[4]=i):i=e[4];const o=a.total===0?"hidden":"visible";let g;e[5]!==u?(g=()=>u.current,e[5]=u,e[6]=g):g=e[6];let h;e[7]!==a.results?(h=a.results.map(X),e[7]=a.results,e[8]=h):h=e[8];let w;e[9]!==r||e[10]!==n?(w=async v=>{const{results:b,total_pages:x}=await r(n,v+1);return v<x?b.map(X):null},e[9]=r,e[10]=n,e[11]=w):w=e[11];let k;e[12]===Symbol.for("react.memo_cache_sentinel")?(k=m.jsx(re,{}),e[12]=k):k=e[12];let y;e[13]!==n?(y=n&&m.jsx(B,{paddingX:2,paddingY:3,children:m.jsx(S,{size:1,muted:!0,children:"No more results"})}),e[13]=n,e[14]=y):y=e[14];let P;e[15]!==s||e[16]!==c?(P=async v=>{const{photo:b}=v,{data:x}=b,j=await De(s,x),M=x.description||void 0,N={kind:"url",value:j,assetDocumentProps:{_type:"sanity.imageAsset",source:{name:"unsplash",id:x.id,url:x.links.html},description:M,creditLine:`${x.user.name} by Unsplash`}};return c([N])},e[15]=s,e[16]=c,e[17]=P):P=e[17];let C;e[18]===Symbol.for("react.memo_cache_sentinel")?(C=[],e[18]=C):C=e[18];let $;e[19]===Symbol.for("react.memo_cache_sentinel")?($=m.jsx(Le,{photos:C,spacing:V,padding:Be,targetRowHeight:Ve,render:{extras:qe},componentsProps:{container:{style:{marginBottom:V}}}}),e[19]=$):$=e[19];let E;e[20]!==n||e[21]!==P||e[22]!==g||e[23]!==h||e[24]!==w||e[25]!==y?(E=m.jsx(_e,{scrollContainer:g,photos:h,fetch:w,loading:k,finished:y,onClick:P,children:$},n),e[20]=n,e[21]=P,e[22]=g,e[23]=h,e[24]=w,e[25]=y,e[26]=E):E=e[26];let R;e[27]!==E||e[28]!==o?(R=m.jsx(p.Activity,{mode:o,children:E}),e[27]=E,e[28]=o,e[29]=R):R=e[29];let O;return e[30]!==R||e[31]!==i?(O=m.jsxs(m.Fragment,{children:[i,R]}),e[30]=R,e[31]=i,e[32]=O):O=e[32],O}function qe(t,e){return m.jsx(Fe,{id:e.photo.data.id,link:e.photo.data.links.html,userName:e.photo.data.user.username})}function Ve(t){return t<300?150:t<600?200:300}export{Ye as default};
